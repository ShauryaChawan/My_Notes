[üè† Home](../../../README.md) <br/>
[üçµ Java Home](../Java.md)

<hr/>

<h1 style="text-align: center">30. Java Exception Handling</h1>

- [Introduction](#introduction)
- [Throwable Hierarchy](#throwable-hierarchy)
- [Exception Handling Keywords and Constructs](#exception-handling-keywords-and-constructs)
  - [`try-catch` Block:](#try-catch-block)
  - [`throw` keyword:](#throw-keyword)
  - [`finally` keyword:](#finally-keyword)
- [Real Life Example](#real-life-example)
- [Best Practices in Exception Handling](#best-practices-in-exception-handling)
- [Custom Exception](#custom-exception)
- [`try-with-resources`](#try-with-resources)
- [Interview Questions üéØ](#interview-questions-)
  - [1. Error vs Exception‚ùì](#1-error-vs-exception)
  - [2. throw`vs`throws\` Keywords‚ùì](#2-throwvsthrows-keywords)
  - [3. Check Exception vs Unchecked Exeption‚ùì](#3-check-exception-vs-unchecked-exeption)
  - [4. `ClassNotFoundException` vs `NoClassDefFoundError`‚ùì](#4-classnotfoundexception-vs-noclassdeffounderror)
  - [5. How Does JVM Handle an Exception‚ùì](#5-how-does-jvm-handle-an-exception)
  - [6. If a parent method throws an exception, then how a child class can resolve/handle it‚ùì](#6-if-a-parent-method-throws-an-exception-then-how-a-child-class-can-resolvehandle-it)
  - [7. Does `finally` always execute in Java‚ùì](#7-does-finally-always-execute-in-java)
  - [8. What if the `main()`method throws an exception‚ùì](#8-what-if-the-mainmethod-throws-an-exception)
  - [9. What is the meaning of `unreachable catch block for ‚Ä¶` error‚ùì](#9-what-is-the-meaning-of-unreachable-catch-block-for--error)
  - [10. When \& why `try-with-recourses` block was introduced‚ùì](#10-when--why-try-with-recourses-block-was-introduced)
  - [11. `final` vs `finalize` vs `finally`‚ùì](#11-final-vs-finalize-vs-finally)
  - [12. What is Exception Propagation‚ùì](#12-what-is-exception-propagation)
  - [13. What is Chained Exceptions‚ùì](#13-what-is-chained-exceptions)

<hr/>

## Introduction

- Exception handling in Java is a mechanism used to manage runtime errors, known as exceptions, that occur during the execution of a program. 
- It allows developers to gracefully handle unexpected situations and ensure the robustness of their applications. 

## Throwable Hierarchy

![alt text](../images/Throwable%20Hierarchy.png)

1. **Throwable**

- At the top of the hierarchy is the `Throwable` class. 
- It is the superclass of all errors and exceptions in Java.
- **Methods:** Includes methods for retrieving the exception message, stack trace, and cause.

2. **Error**

- `Error` is a subclass of `Throwable`. 
- It represents serious problems that a typical application should not try to catch. 
- Errors are usually generated by the JVM or are indicative of serious system failures.
- Common Subclasses:
  - `OutOfMemoryError`: Indicates that the JVM has run out of memory.
  - `StackOverflowError`: Indicates that the stack has overflowed, usually due to deep recursion.
  - `VirtualMachineError`: A superclass for errors related to the JVM.

3. **Exceptions**
   - The Exception class is used for exceptional conditions that applications might want to catch. 
   - This includes a wide range of issues, such as `IOException`, `ClassNotFoundException`, and `NullPointerException`
   - Types of Exceptions
     - **Checked Exceptions:** 
       - These are exceptions that are checked at compile-time. 
       - These exceptions are subclasses of `Exception` but not subclasses of `RuntimeException`.
     - **Unchecked Exceptions (Runtime Exceptions):** 
       - These are exceptions that occur at runtime and are subclasses of `RuntimeException`. 
       - They typically indicate programming errors such as division by zero, null pointer dereference, etc.

## Exception Handling Keywords and Constructs

### `try-catch` Block:

- The try-catch block is used to handle exceptions. 
- Code that might throw an exception is placed inside the try block, and the corresponding catch blocks handle the exceptions if they occur.

**Syntax and Example:**
```java
try {
    // Code that might throw an exception
} catch (ExceptionType1 e1) {
    // Handle exception of type ExceptionType1
} catch (ExceptionType2 e2) {
    // Handle exception of type ExceptionType2
} finally {
    // Optional block executed after try/catch regardless of whether an exception occurred or not
}
```

### `throw` keyword:

- The `throw` keyword is used to explicitly throw an exception. It is followed by an instance of `Throwable` (usually an exception object) that indicates the type of exception being thrown.

**Example:**
```java
throw new Exception("Something went wrong");
```

- The `throws` keyword is used in method signatures to declare that a method may throw one or more exceptions. It informs the caller of the method about the exceptions that need to be handled.

**Example:**
```java
public void someMethod() throws IOException, SQLException {
    // Method code that might throw IOException or SQLException
}
```

### `finally` keyword:

The finally block is used to execute important code such as closing resources (like files, sockets, etc.) whether an exception is thrown or not.

**Syntax and Example:**
```java
try {
    // Code that might throw an exception
} catch (Exception e) {
    // Handle exception
} finally {
    // Code that will always execute, regardless of whether an exception occurred or not
}
```
OR
```java
try {
    // Code that might throw an exception
} finally {
    // Code that will always execute, regardless of whether an exception occurred or not
}
```
## Real Life Example

```java
import java.io.File;
import java.io.FileNotFoundException;
import java.util.Scanner;

public class FileHandlingExample {

  public static void main(String[] args) {
    // Replace with the path to an existing file on your system
    String filePath = "path/to/your/file.txt";

    try {
      readFileContents(filePath);
    } catch (FileNotFoundException e) {
      System.err.println("File not found: " + e.getMessage());
      // Optionally, handle the exception or rethrow it
    } catch (Exception e) {
      System.err.println("Exception occurred: " + e.getMessage());
    } finally {
      System.out.println("Executing finally block.");
      // Close any resources here, if needed
    }

    System.out.println("End of program.");
  }

  public static void readFileContents(String filePath) throws FileNotFoundException {
    File file = new File(filePath);
    Scanner scanner = new Scanner(file);

    try {
      // Read file contents line by line
      while (scanner.hasNextLine()) {
        String line = scanner.nextLine();
        System.out.println(line);
      }
    } finally {
      // Close the scanner in the finally block to ensure it gets closed
      if (scanner != null) {
        scanner.close();
      }
    }
  }
}
```

## Best Practices in Exception Handling

- **Catch Specific Exceptions:**
  - Handle specific exceptions rather than catching `Exception` to avoid masking other potential issues.
- **Clean Up Resources in `finally`:**
  - Use finally for resource cleanup (closing files, database connections) to ensure resources are released even if an exception occurs.
- **Logging Exceptions:**
  - Log exceptions with sufficient information (message, stack trace) to aid debugging.
- **Use Custom Exceptions:**
  - Define custom exception classes for specific application-level errors to provide meaningful error messages and context.
- **Avoid Swallowing Exceptions:**
  - Avoid scenarios where exceptions are caught but not handled appropriately. 
  - Consider logging or rethrowing the exception if it cannot be handled locally.

## Custom Exception

```java
// Custom Exception class
class InvalidAgeException extends Exception {
  public InvalidAgeException(String message) {
    super(message);
  }
}

// Example class that uses the custom exception
class Voter {
  private String name;
  private int age;

  public Voter(String name, int age) throws InvalidAgeException {
    this.name = name;

    if (age < 18) {
      throw new InvalidAgeException("Invalid age for voting: " + age);
    }

    this.age = age;
  }

  public void castVote() {
    System.out.println(name + " has cast the vote.");
  }
}

// Main class to demonstrate custom exception usage
public class Main {
  public static void main(String[] args) {
    try {
      Voter voter1 = new Voter("Alice", 20);
      voter1.castVote(); // Outputs: Alice has cast the vote.

      Voter voter2 = new Voter("Bob", 16); // This will throw InvalidAgeException
      voter2.castVote(); // This line won't execute due to exception
    } catch (InvalidAgeException e) {
      System.out.println("Exception caught: " + e.getMessage());
      // Handle the exception or provide feedback to the user
    }
  }
}
```

## `try-with-resources`

- The `try-with-resources` statement in Java is used to automatically close resources that implement `java.lang.AutoCloseable` or `java.io.Closeable` interfaces. 
- It ensures that each resource is closed at the end of the statement, whether the try block completes normally or throws an exception.

**Example:**

```java
import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;

public class Main {
  public static void main(String[] args) {
    String filePath = "sample.txt";

    // try with resources
    try (BufferedReader reader = new BufferedReader(new FileReader(filePath))) {
      String line;
      while ((line = reader.readLine()) != null) {
        System.out.println(line);
      }
    } catch (IOException e) {
      System.out.println("Error reading file: " + e.getMessage());
    }
  }
}
```



<hr/>

## Interview Questions üéØ

### 1. Error vs Exception‚ùì

| Aspect                 | Errors                                     | Exceptions                                |
|------------------------|--------------------------------------------|-------------------------------------------|
| **Definition**         | Serious issues that usually cannot be handled or recovered from (e.g., `OutOfMemoryError`). | Issues that can be handled and recovered from (e.g., `IOException`). |
| **Inheritance**        | Directly inherits from `java.lang.Error`.  | Directly inherits from `java.lang.Exception`. |
| **Handling**           | Generally not meant to be caught or handled. | Intended to be caught and handled by code. |
| **Typical Causes**     | JVM issues, system failures (e.g., stack overflow, virtual machine errors). | Application logic errors, external conditions (e.g., file not found, network issues). |
| **Examples**           | `OutOfMemoryError`, `StackOverflowError`.  | `IOException`, `NullPointerException`.    |
| **Recovery**           | Usually not recoverable.                   | Can often be recovered from with proper handling. |


<hr>

### 2. throw` vs `throws` Keywords‚ùì

| Aspect        | `throw`                                             | `throws`                                      |
|---------------|-----------------------------------------------------|-----------------------------------------------|
| **Usage**     | Used to explicitly throw an exception from within a method or block of code. | Used in a method signature to declare that a method can throw certain exceptions. |
| **Location**  | Appears within the method or block of code where the exception is thrown. | Appears in the method declaration (signature) to indicate which exceptions might be thrown. |
| **Example**   | ```java throw new IOException("File not found"); ``` | ```java public void readFile() throws IOException { ... } ``` |
| **Purpose**   | To actually create and throw an instance of an exception. | To inform callers of the method about potential exceptions that need to be handled. |

```java
import java.io.IOException;

public class Example {

    // Method that declares it can throw IOException
    public void readFile(String fileName) throws IOException {
        if (fileName == null || fileName.isEmpty()) {
            // Throwing an exception using 'throw'
            throw new IOException("File name cannot be null or empty");
        }
        // Simulate file reading
        System.out.println("Reading file: " + fileName);
    }

    public static void main(String[] args) {
        Example example = new Example();
        try {
            // Calling a method that can throw IOException
            example.readFile(""); // This will throw an exception
        } catch (IOException e) {
            // Handling the exception
            System.out.println("Caught an exception: " + e.getMessage());
        }
    }
}

```

**Explanation:**
- `throws`: The `readFile` method declares that it can throw an `IOException`. This is specified in the method signature: `public void readFile(String fileName) throws IOException`.
- `throw`: Inside the `readFile` method, the `throw` keyword is used to actually throw an `IOException` if the file name is invalid.

<hr>

### 3. Check Exception vs Unchecked Exeption‚ùì


| Aspect                   | Checked Exceptions                           | Unchecked Exceptions                        |
|--------------------------|----------------------------------------------|---------------------------------------------|
| **Definition**           | Exceptions that are checked at compile-time. | Exceptions that are checked at runtime.    |
| **Inheritance**          | Directly inherit from `java.lang.Exception`, but not from `java.lang.RuntimeException`. | Directly inherit from `java.lang.RuntimeException`. |
| **Handling**             | Must be caught or declared in the method signature using `throws`. | Optional to catch; they are not required to be declared. |
| **Typical Causes**       | Issues that are anticipated and recoverable (e.g., file handling, network issues). | Issues that are usually programming errors (e.g., null pointer access, arithmetic errors). |
| **Examples**             | `IOException`, `SQLException`.               | `NullPointerException`, `ArithmeticException`. |
| **Purpose**              | To handle exceptional conditions that are outside the control of the program but can be anticipated. | To handle errors that indicate programming mistakes or logic issues. |

<hr>

### 4. `ClassNotFoundException` vs `NoClassDefFoundError`‚ùì

| Aspect                   | `ClassNotFoundException`                          | `NoClassDefFoundError`                        |
|--------------------------|----------------------------------------------------|-----------------------------------------------|
| **Type**                 | Checked Exception                                 | Error                                         |
| **When Thrown**          | Thrown when an application attempts to load a class through its name but the class cannot be found. | Thrown when the JVM or a ClassLoader tries to load a class that was available during compile-time but is no longer present at runtime. |
| **Typical Causes**       | The classpath is incorrect or the class file is missing. | The class file was present during compilation but is missing or corrupted at runtime. |
| **Handling**             | Must be caught or declared in the method signature using `throws`. | Typically not caught; represents a serious problem indicating a class definition issue. |
| **Examples**             | ```java Class.forName("com.example.MyClass"); ``` | ```java new MyClass(); // if MyClass is not found at runtime. ``` |
| **Purpose**              | To handle situations where a class needed for dynamic loading is not found. | To indicate that a class which was available during compilation cannot be found at runtime, often due to classpath issues or changes. |

<hr>

### 5. How Does JVM Handle an Exception‚ùì



<hr>

### 6. If a parent method throws an exception, then how a child class can resolve/handle it‚ùì



<hr>

### 7. Does `finally` always execute in Java‚ùì



<hr>

### 8. What if the `main()`method throws an exception‚ùì



<hr>

### 9. What is the meaning of `unreachable catch block for ‚Ä¶` error‚ùì



<hr>

### 10. When & why `try-with-recourses` block was introduced‚ùì



<hr>

### 11. `final` vs `finalize` vs `finally`‚ùì



<hr>

### 12. What is Exception Propagation‚ùì



<hr>

### 13. What is Chained Exceptions‚ùì



<hr>


<hr/>

[üè† Home](../../../README.md) <br/>
[üçµ Java Home](../Java.md)
