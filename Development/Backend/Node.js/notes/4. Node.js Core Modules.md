[🏠 Home](../../../README.md) <br/>
[Node.js Home](../notes/)

---

<h1 style="text-align: center">4. Node.js Core Modules</h1>

## Index
- [Index](#index)
- [Introduction](#introduction)
- [1. Global Objects and Modules](#1-global-objects-and-modules)
- [2. Importing/Exporting Modules (`require` and `module.exports`)](#2-importingexporting-modules-require-and-moduleexports)
	- [2.1. Importing Modules with `require()`](#21-importing-modules-with-require)
	- [2.2 Exporting Modules with module.exports](#22-exporting-modules-with-moduleexports)
- [3 Key Core Modules](#3-key-core-modules)
	- [3.1 `fs` (File System Module)](#31-fs-file-system-module)
	- [3.2. `path` (Path Module)](#32-path-path-module)
	- [3.3 `os` (Operating System Module)](#33-os-operating-system-module)
	- [3.4 `events` (EventEmitter Module)](#34-events-eventemitter-module)
	- [3.5 `util` (Utility Module)](#35-util-utility-module)

---

## Introduction

Node.js comes with a set of built-in modules that provide essential functionalities for building server-side applications. These modules are part of the Core API and don't require installation through a package manager (like npm). By leveraging these core modules, developers can access system functionalities such as file manipulation, networking, and operating system interaction.

---

[⬆️ Back to TOP ⬆️](#index)

## 1. Global Objects and Modules

Node.js provides several global objects that are available in every module and can be accessed without importing them. These objects represent various utilities, such as file system access, process management, and timers.

**Key Global Objects:**

1. `global`

   - This is the global namespace object in Node.js. Any variable attached to global can be accessed anywhere in the Node.js application.
   - Example:

	```js
	global.myGlobalVar = 'This is global';
	// Output: 'This is global'
	console.log(global.myGlobalVar); 
	```

2. `process`

   - Provides information about and control over the current Node.js process. It is widely used to access environment variables, handle events like exiting the process, and more.
   - Example:

	```js
	// Access environment variables
	console.log(process.env.NODE_ENV); 
	// Exit the process with status code 1
	process.exit(1); 
	```

3. `__dirname`

   - Represents the directory name of the current module file.
   - Example:

	```js
	console.log(__dirname); 
	// Outputs the path to the current directory
	```

4. `__filename`

   - Represents the file name of the current module, including the full path.
   - Example:

	```js
	console.log(__filename); 
	// Outputs the path to the current file
	```

5. Timers

   - These include `setTimeout()`, `setInterval()`, and `setImmediate()` which are available globally and don’t need to be required from a module.
   - Example:

```js
setTimeout(() => {
  console.log('Executed after 2 seconds');
}, 2000);
```

**Global Scope Consideration:**

- Unlike the browser's global window object, Node.js modules have their own scope. 
- This means that variables or functions declared in one file are not accessible in another unless they are explicitly exported and imported.

---

[⬆️ Back to TOP ⬆️](#index)

## 2. Importing/Exporting Modules (`require` and `module.exports`)

- Modules in Node.js are files or libraries that help break your application into reusable pieces of code. 
- By default, each file in Node.js is treated as a module. 
- Node.js provides mechanisms to both import and export code across files.

### 2.1. Importing Modules with `require()`

- `require()` is used to load modules in Node.js, which can be:
  - Core modules (e.g., `fs`, `path`)
  - Custom modules (e.g., user-created files)
  - Third-party modules installed via npm

```js
// Importing the 'fs' core module
const fs = require('fs');

// Importing a custom module (e.g., './myModule.js')
const myModule = require('./myModule');
```

---

### 2.2 Exporting Modules with module.exports

- `module.exports` is used to export functions, objects, or variables from a module so they can be imported and used in other modules.
- Example:

```js
// myModule.js
function greet(name) {
  return `Hello, ${name}!`;
}

module.exports = greet; 
// Exporting the 'greet' function

// -----

// In another file (app.js)
const greet = require('./myModule');
console.log(greet('John')); 
// Output: 'Hello, John!'
```

**ES6 Syntax (`import/export`)**

- Since Node.js v12, ES6-style import/export is natively supported using the .mjs extension.

Example:

```js
// myModule.js
export function greet(name) {
  return `Hello, ${name}!`;
}

// -----

// app.mjs
import { greet } from './myModule.mjs';
console.log(greet('John')); 
// Output: 'Hello, John!'

```

[⬆️ Back to TOP ⬆️](#index)

## 3 Key Core Modules

- Node.js provides a variety of core modules that come pre-installed with Node.js. 
- These modules are foundational and provide access to crucial system functionalities like file systems, network, and operating systems.

### 3.1 `fs` (File System Module)

The `fs` module allows you to interact with the file system. You can read, write, append, delete, and manipulate files and directories.

1. Reading a File:
   1. Asynchronous:
		```js
		const fs = require('fs');

		fs.readFile('example.txt', 'utf-8', (err, data) => {
			if (err) {
				console.error('Error reading file:', err);
			} else {
				console.log('File content:', data);
			}
		});
		```
   2. Synchronous
		```js
		const data = fs.readFileSync('example.txt', 'utf-8');
		console.log(data);
		```

2. Writing to a File: (Asynchronous)

```js
const fs = require('fs');

fs.writeFile('example.txt', 'Hello World!', (err) => {
  if (err) {
    console.error('Error writing to file:', err);
  } else {
    console.log('File written successfully');
  }
});
```

3. Appending to a File:

```js
const fs = require('fs');

fs.appendFile('example.txt', '\nAppended text', (err) => {
  if (err) {
    console.error('Error appending to file:', err);
  } else {
    console.log('File appended successfully');
  }
});
```

4. Deleting a File:

```js
const fs = require('fs');

fs.unlink('example.txt', (err) => {
  if (err) {
    console.error('Error deleting file:', err);
  } else {
    console.log('File deleted successfully');
  }
});
```

---

[⬆️ Back to TOP ⬆️](#index)

### 3.2. `path` (Path Module)

The `path` module provides utilities for working with file and directory paths. It is especially useful for handling file paths in a cross-platform way (e.g., Windows vs. Linux).

1. Getting the directory name:

```js
const path = require('path');
console.log(path.dirname('/home/user/file.txt')); 
// Output: '/home/user'
```

2. Joining paths:

```js
const path = require('path');
const fullPath = path.join('/home', 'user', 'file.txt');
console.log(fullPath); 
// Output: '/home/user/file.txt'
```

3. Getting the file extension:

```js
const path = require('path');
console.log(path.extname('file.txt')); 
// Output: '.txt'
```

---

[⬆️ Back to TOP ⬆️](#index)

### 3.3 `os` (Operating System Module)

The os module provides methods to interact with the underlying operating system.

1. Getting system information:

```js
const os = require('os');

console.log('OS Platform:', os.platform()); 
// e.g., 'linux', 'win32'
console.log('CPU Architecture:', os.arch()); 
// e.g., 'x64'
```

2. Getting memory information:

```js
console.log('Total Memory:', os.totalmem()); 
// Total system memory in bytes
console.log('Free Memory:', os.freemem()); 
// Free memory in bytes
```

---

[⬆️ Back to TOP ⬆️](#index)

### 3.4 `events` (EventEmitter Module)

Node.js is event-driven, and the events module is at the core of this architecture. It provides the EventEmitter class to handle custom events.

```js
const EventEmitter = require('events');

class MyEmitter extends EventEmitter {}

const myEmitter = new MyEmitter();

// Register an event listener
myEmitter.on('event', () => {
  console.log('An event occurred!');
});

// Emit the event
myEmitter.emit('event');
```

**Key Methods:**

- `.on(event, listener)`: Registers a listener for an event.
- `.emit(event)`: Triggers the event and calls all registered listeners.

---

[⬆️ Back to TOP ⬆️](#index)

### 3.5 `util` (Utility Module)

The util module provides various utility functions that help developers write better code.

**Key Methods:**

1. `util.promisify()`: Converts callback-based functions to promise-based functions.

```js
const util = require('util');
const fs = require('fs');

const readFile = util.promisify(fs.readFile);
readFile('example.txt', 'utf-8')
  .then(data => console.log(data))
  .catch(err => console.error(err));

```

2. `util.format()`: Formats strings using placeholders like `%s`, `%d`, etc.

```js
const util = require('util');
const message = util.format('My name is %s and I am %d years old.', 'John', 30);
console.log(message); 
// Output: 'My name is John and I am 30 years old.'
```

---

[🏠 Home](../../../README.md) <br/>
[Node.js Home](../notes/)